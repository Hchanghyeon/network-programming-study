### JPA에서의 N+1 문제를 해결하기 위한 Batch Size의 적절한 값
- 우선 Batch Size를 실제 데이터 수보다 크게 적용할 때의 문제점
  - 예를 들어, 실제 데이터 수는 20개지만 100으로 설정할 경우 실제 쿼리는 1개가 아닌 여러 개로 나누어져 발생되고 In쿼리에 들어가는 데이터의 개수도 이상함
    - 2개의 쿼리가 날라가고, 8/12 개로 분리되어 날아감
    - JDBC의 preparedstatement의 캐싱 방식
      - in 절이 들어가는 select 쿼리에 대해 각 경우를 캐싱함
      ```java
      # 데이터가 1개 들어올 때 : where xxx in (?)
      # 데이터가 2개 들어올 때 : where xxx in (?,?)
      # 데이터가 n개 들어올 때 : where xxx in (?,?, ...)
      ```
      - 참고 https://42class.com/dev/jpa-batchsize/
      - 100을 설정할 경우 2배 수로 줄여가면서 50, 25, 12, 10, 9, 8 ~ 1 까지 캐싱해둠
      - 모든 항목에 대해서 캐싱할 경우 성능에 문제가 발생됨
    - 결국 20개가 날라오더라도 20개를 처리할 수 있는 캐싱된 데이터로 처리하기 때문에 12개, 8개로 처리됨
- 결국 Batch Size를 조절하기 위해서는 실제 쿼리에 대해 평균 어느정도 건 수로 날라가는지 파악이 필요할 것 같고, 그 수를 통해 최적의 개수를 산정하는 것이 좋을 것 같음